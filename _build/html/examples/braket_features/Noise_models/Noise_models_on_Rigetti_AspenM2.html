<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Noise models on Rigetti Aspen-M-2 - Amazon Braket Examples documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Amazon Braket Examples  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Amazon Braket Examples  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  
</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="noise-models-on-rigetti-aspen-m-2">
<h1>Noise models on Rigetti Aspen-M-2<a class="headerlink" href="#noise-models-on-rigetti-aspen-m-2" title="Permalink to this heading">#</a></h1>
<p>This notebook shows how to construct a noise model from device calibration data for Rigetti Aspen-M-2. We compare the measurement outcomes of circuits run on a noisy simulator with the same circuits run on quantum processing units (QPUs), to show that simulating circuits with noise models more closely mimics QPUs.</p>
<p><strong>Before you begin</strong>: We recommend being familiar with <a class="reference external" href="https://github.com/aws/amazon-braket-examples/blob/main/examples/braket_features/Noise_models/Noise_models_on_Amazon_Braket.ipynb">Noise models on Amazon Braket.</a>
Additionally, users should be familiar with <a class="reference external" href="https://github.com/aws/amazon-braket-examples/blob/main/examples/getting_started/2_Running_quantum_circuits_on_QPU_devices/2_Running_quantum_circuits_on_QPU_devices.ipynb">Running quantum circuits on QPU devices</a>.</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Noise model for Rigetti  Aspen-M-2</p>
<ul>
<li><p>Loading device calibration data</p></li>
<li><p>Comparing noisy simulator results to QPU results</p></li>
<li><p>Smaller noise models compared to QPU results</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">braket.aws</span> <span class="kn">import</span> <span class="n">AwsDevice</span>
<span class="kn">from</span> <span class="nn">braket.circuits</span> <span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">Gate</span><span class="p">,</span> <span class="n">Noise</span><span class="p">,</span> <span class="n">Observable</span>
<span class="kn">from</span> <span class="nn">braket.circuits.noise_model</span> <span class="kn">import</span> <span class="p">(</span><span class="n">GateCriteria</span><span class="p">,</span> <span class="n">NoiseModel</span><span class="p">,</span>
                                         <span class="n">ObservableCriteria</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">braket.circuits.noises</span> <span class="kn">import</span> <span class="p">(</span><span class="n">AmplitudeDamping</span><span class="p">,</span> <span class="n">BitFlip</span><span class="p">,</span> <span class="n">Depolarizing</span><span class="p">,</span>
                                    <span class="n">PauliChannel</span><span class="p">,</span> <span class="n">PhaseDamping</span><span class="p">,</span> <span class="n">PhaseFlip</span><span class="p">,</span>
                                    <span class="n">TwoQubitDepolarizing</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">braket.devices</span> <span class="kn">import</span> <span class="n">LocalSimulator</span>
</pre></div>
</div>
</div>
</div>
<p>Braket provides access to hardware providers’ reported calibration data.
This can be used to construct noise models to approximate the behavior of the QPU when running circuits on a noisy simulator.
In this tutorial, we focus on local noise models with no crosstalk interactions. Real devices can have crosstalk and unexpected effects that can further degrade the results.</p>
<p>The Aspen-M-2 calibration data is available on the Braket devices page. Under qubit specs, the calibration data include the qubit index, with corresponding values for the $T_1$, $T_2$, fidelity from randomized benchmarking (fRB),  fidelity from simultaneous randomized benchmarking (fsRB),  readout fidelity (fRO), and active reset fidelity.
Under “edge specs”, the data includes the RB fidelity for C-Phase, XY, and CZ gates for each connected edge in the device topology.</p>
<p><strong>One-qubit calibration data (Qubit specs)</strong></p>
<div align=center><img src="aspenm2_qubit_specs.png"/></div>
<p><strong>Two-qubit calibration data (Edge specs)</strong></p>
<div align=center><img src="aspenm2_edge_specs.png"/></div><p>We can programmatically access all the calibration data with the Braket SDK. First we load the AwsDevice using the ARN for Rigetti Aspen-M-2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspen_m_2</span> <span class="o">=</span> <span class="n">AwsDevice</span><span class="p">(</span><span class="s2">&quot;arn:aws:braket:us-west-1::device/qpu/rigetti/Aspen-M-2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The properties dictionary contains keys “provider” and “specs”, with “1Q” and “2Q” keys for the one- and two-qubit calibration data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspen_m_2_specs</span> <span class="o">=</span> <span class="n">aspen_m_2</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">dict</span><span class="p">()[</span><span class="s2">&quot;provider&quot;</span><span class="p">][</span><span class="s2">&quot;specs&quot;</span><span class="p">]</span>

<span class="n">one_qubit_data</span> <span class="o">=</span> <span class="n">aspen_m_2_specs</span><span class="p">[</span><span class="s2">&quot;1Q&quot;</span><span class="p">]</span>
<span class="n">two_qubit_data</span> <span class="o">=</span> <span class="n">aspen_m_2_specs</span><span class="p">[</span><span class="s2">&quot;2Q&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The keys of the “1Q” dictionary is the qubit number.
For Aspen-M-2, there are 80 qubits indexed by the first digit representing the octagon (0 to 4, and 10 to 14)
and the second representing the qubit in that octagon (0 to 7). We can get all qubit indices with <code class="docutils literal notranslate"><span class="pre">one_qubit_data.keys()</span></code> or with <code class="docutils literal notranslate"><span class="pre">aspen_m_2.topology_graph.nodes</span></code>.</p>
<p>The keys of the “2Q” dictionary are the connected qubit pairs separated by a hyphen.
For example, if qubit 0 and 1 are connected the key is “0-1”.</p>
<section id="one-qubit-noise">
<h3>One-qubit noise<a class="headerlink" href="#one-qubit-noise" title="Permalink to this heading">#</a></h3>
<p>Let’s look at the one qubit calibration data for qubit 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_qubit_data</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;T1&#39;: 2.4443429874176914e-05,
 &#39;T2&#39;: 1.627681336532139e-05,
 &#39;f1QRB&#39;: 0.9985669301541129,
 &#39;f1QRB_std_err&#39;: 0.0004092835114091019,
 &#39;f1Q_simultaneous_RB&#39;: 0.9977676229871197,
 &#39;f1Q_simultaneous_RB_std_err&#39;: 0.00021522363993495725,
 &#39;fActiveReset&#39;: 0.9905000000000002,
 &#39;fRO&#39;: 0.9795}
</pre></div>
</div>
</div>
</div>
<p>For each qubit, there are various metrics of the quality:</p>
<ul class="simple">
<li><p><strong>T1</strong>: Thermal relaxation time is related to the time it takes for the excited state, |1⟩, to decay into the ground state, |0⟩. The probability of remaining in the excited state is $p(|1⟩)\sim e^{-t/T_1}$</p></li>
<li><p><strong>T2</strong>: The dephasing time, is the decay constant for the scale for a |+⟩ state to decohere into the completely mixed state. $p(|+⟩)\sim e^{-t/T_2}$</p></li>
<li><p><strong>Fidelity (RB)</strong>: Single-qubit randomized benchmarking fidelities. RB fidelity quantifies the average gate fidelity where the average is over all Clifford gates. RB describes an <em>effective</em> noise model with gate-independent depolarizing noise on each Clifford gate.</p></li>
<li><p><strong>Fidelity (sRB)</strong>: Single-qubit simultaneous randomized benchmarking fidelities. These are extracted by running single-qubit RB on all qubits simultaneously. Note that we expect the sRB fidelity to be lower than standard RB fidelity due to non-local crosstalk type noise on the device.</p></li>
<li><p><strong>Active reset fidelity</strong>: Single-qubit active reset fidelities represents the accuracy to which qubits are reinitalized into the ground state |0⟩.</p></li>
<li><p><strong>Readout fidelity</strong>: Single-qubit readout fidelities describes the probability of a bit flip error before readout in the computational basis. The readout fidelity is related to the probability of correctly measuring the ground state and excited states respectively, e.g. $f_{RO} =\frac{p(0|0)+p(1|1)}{2}$</p></li>
</ul>
<p>Now that we know how to extract and use the calibration data, we can build a simple noise model. For every qubit we will add:</p>
<ul class="simple">
<li><p>amplitude dampening noise with probability $p= 1-e^{-t/T_1}$ for every gate</p></li>
<li><p>phase dampening noise with probability $p= 0.5(1-e^{-t/T_2})$ for every gate</p></li>
<li><p>depolarizing noise with probability $p=1-f_{sRB}$ (from simultaneous RB fidelity) for  every gate</p></li>
<li><p>readout bit flip noise with probability $p=1-f_{RO}$ to measurements</p></li>
</ul>
<p>Technically, the sRB fidelity already includes effects from $T_1$/$T_2$, however to be explicit we add these as separate terms. In a sense, this model might overestimate the noise on the QPU.</p>
<p>For the dampening noises, we first need the gate times to model $T_1$ and $T_2$ errors.
From the Braket Aspen-M-2 device page: “These gates offer fast (40ns and 180ns) 1Q and 2Q gate times.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># median 1q and 2q gate times</span>
<span class="n">gate_time_1_qubit</span> <span class="o">=</span> <span class="mf">40e-9</span>
<span class="n">gate_time_2_qubit</span> <span class="o">=</span> <span class="mf">180e-09</span>
</pre></div>
</div>
</div>
</div>
<p>To create the noise model, we iterate over all qubits keys in <code class="docutils literal notranslate"><span class="pre">one_qubit_data</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_model</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="p">()</span>

<span class="c1"># Single-qubit noise</span>
<span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">one_qubit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># iterate over qubits</span>

    <span class="c1"># T1 dampening</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;T1&quot;</span><span class="p">]</span>
    <span class="n">damping_prob</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">gate_time_1_qubit</span> <span class="o">/</span> <span class="n">t1</span><span class="p">))</span>
    <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">AmplitudeDamping</span><span class="p">(</span><span class="n">damping_prob</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>

    <span class="c1"># T2 phase flip</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;T2&quot;</span><span class="p">]</span>
    <span class="n">dephasing_prob</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">gate_time_1_qubit</span> <span class="o">/</span> <span class="n">t2</span><span class="p">)))</span>
    <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">PhaseDamping</span><span class="p">(</span><span class="n">dephasing_prob</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>

    <span class="c1"># 1q RB depolarizing rate from simultaneous RB</span>
    <span class="n">depolar_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;f1Q_simultaneous_RB&quot;</span><span class="p">]</span>
    <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">Depolarizing</span><span class="p">(</span><span class="n">depolar_rate</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>

    <span class="c1"># 1q RB readout</span>
    <span class="n">readout_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fRO&quot;</span><span class="p">]</span>
    <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">BitFlip</span><span class="p">(</span><span class="n">readout_value</span><span class="p">),</span> <span class="n">ObservableCriteria</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_params</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">instructions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of terms in noise model is: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">noise_model</span><span class="o">.</span><span class="n">instructions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of parameters in noise model is: </span><span class="si">{</span><span class="n">num_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of terms in noise model is: 320
Number of parameters in noise model is: 320
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-qubit-noise">
<h3>Two-qubit noise<a class="headerlink" href="#two-qubit-noise" title="Permalink to this heading">#</a></h3>
<p>Next we consider adding two-qubit noise to the model.</p>
<p>Let’s first look at the data provided in the Aspen-M-2 device calibration data. On the first connect, “0-1”, the properties are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two_qubit_data</span><span class="p">[</span><span class="s2">&quot;0-1&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;fCPHASE&#39;: 0.8991973184700036,
 &#39;fCPHASE_std_err&#39;: 0.019391126441846068,
 &#39;fCZ&#39;: 0.9406104552003762,
 &#39;fCZ_std_err&#39;: 0.011069113247524152,
 &#39;fXY&#39;: 0.8365560014004874,
 &#39;fXY_std_err&#39;: 0.014585224789608713}
</pre></div>
</div>
</div>
</div>
<p>Here, we see the fidelity per gate (CPhase, CZ, or XY) and the associated standard error.</p>
<p>Next we loop over the entries in the <code class="docutils literal notranslate"><span class="pre">two_qubit_data</span></code> dictionary and add two-qubit depolarizing noise to the model. Notice that Aspen-M-2 has symmetric connections (“0-1” and “1-0”) so we need to add noise in both directions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Two-qubit noise</span>
<span class="k">for</span> <span class="n">pair</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">two_qubit_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># iterate over qubit connections</span>

    <span class="c1"># parse strings &quot;0-1&quot; to integers [0, 1]</span>
    <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">pair</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="s2">&quot;fCPHASE&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">phase_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fCPHASE&quot;</span><span class="p">]</span>
        <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span>
            <span class="n">TwoQubitDepolarizing</span><span class="p">(</span><span class="n">phase_rate</span><span class="p">),</span>
            <span class="n">GateCriteria</span><span class="p">(</span>
                <span class="n">Gate</span><span class="o">.</span><span class="n">CPhaseShift</span><span class="p">,</span> <span class="p">[(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">),</span> <span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)]</span>
            <span class="p">),</span>  <span class="c1"># symmetric connections</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;fXY&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">xy_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fXY&quot;</span><span class="p">]</span>
        <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span>
            <span class="n">TwoQubitDepolarizing</span><span class="p">(</span><span class="n">xy_rate</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">(</span><span class="n">Gate</span><span class="o">.</span><span class="n">XY</span><span class="p">,</span> <span class="p">[(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">),</span> <span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)])</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;fCZ&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">cz_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fCZ&quot;</span><span class="p">]</span>
        <span class="n">noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span>
            <span class="n">TwoQubitDepolarizing</span><span class="p">(</span><span class="n">cz_rate</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">(</span><span class="n">Gate</span><span class="o">.</span><span class="n">CZ</span><span class="p">,</span> <span class="p">[(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">),</span> <span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)])</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_params</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">instructions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of terms in noise model is: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">noise_model</span><span class="o">.</span><span class="n">instructions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of parameters in noise model is: </span><span class="si">{</span><span class="n">num_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of terms in noise model is: 612
Number of parameters in noise model is: 612
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="compare-circuits-run-on-device-vs-simulator-with-a-noise-model">
<h2>Compare circuits run on device vs simulator with a noise model<a class="headerlink" href="#compare-circuits-run-on-device-vs-simulator-with-a-noise-model" title="Permalink to this heading">#</a></h2>
<p>Let’s just look at the first 5 qubits. Note that to ensure the noise model applied T1 and T2 noise during the time between gate, we manually add identity gates to each moment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braket.circuits</span> <span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">Noise</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">circ</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T  : |   0    |   1    |2|
                          
q0 : -Rx(0.50)-Rx(3.14)-C-
                        | 
q1 : -Rz(0.50)-Rx(3.14)-Z-
                          
q2 : -Rz(0.50)-Rx(3.14)---

T  : |   0    |   1    |2|
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noisy_circ</span> <span class="o">=</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">noisy_circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T  : |                     0                      |                     1                      |      2      |
                                                                                                              
q0 : -Rx(0.50)-AD(0.0016)--PD(0.0012)-DEPO(0.0022)-Rx(3.14)-AD(0.0016)--PD(0.0012)-DEPO(0.0022)-C-DEPO(0.059)-
                                                                                                | |           
q1 : -Rz(0.50)-AD(0.00086)-PD(0.0015)-DEPO(0.025)--Rx(3.14)-AD(0.00086)-PD(0.0015)-DEPO(0.025)--Z-DEPO(0.059)-
                                                                                                              
q2 : -Rz(0.50)-AD(0.0018)--PD(0.0011)-DEPO(0.0041)-Rx(3.14)-AD(0.0018)--PD(0.0011)-DEPO(0.0041)---------------

T  : |                     0                      |                     1                      |      2      |
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">LocalSimulator</span><span class="p">()</span>  <span class="c1"># noise free simulator</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">100_000</span><span class="p">)</span>
<span class="n">free_probs</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">measurement_probabilities</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noisy_simulator</span> <span class="o">=</span> <span class="n">LocalSimulator</span><span class="p">(</span><span class="s2">&quot;braket_dm&quot;</span><span class="p">)</span>
<span class="n">noisy_task</span> <span class="o">=</span> <span class="n">noisy_simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">noisy_circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">100_000</span><span class="p">)</span>
<span class="n">noisy_probs</span> <span class="o">=</span> <span class="n">noisy_task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">measurement_probabilities</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
<b>Note:</b> The below section runs tasks on the Rigetti Aspen-M-2 device. When you run this notebook, make sure the device is currently available. You can find QPU availability windows on the <a href="https://us-west-1.console.aws.amazon.com/braket/home?region=us-west-1#/devices">Devices page</a> in the Amazon Braket Console.
</div>
<div class="alert alert-block alert-info">
<b>Note:</b> Running the circuit below will result in charges on your AWS account.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspen_m_2_task</span> <span class="o">=</span> <span class="n">aspen_m_2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">100_000</span><span class="p">,</span> <span class="n">disable_qubit_rewiring</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">aspen_m_2_result</span> <span class="o">=</span> <span class="n">aspen_m_2_task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">aspen_m_2_probs</span> <span class="o">=</span> <span class="n">aspen_m_2_result</span><span class="o">.</span><span class="n">measurement_probabilities</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">free_sim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">free_probs</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;free_sim&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">noisy_sim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">noisy_probs</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;noisy_sim&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">aspenm2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">aspen_m_2_probs</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;aspen-m-2&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">aspenm2</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">noisy_sim</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">free_sim</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aspen-m-2</th>
      <th>noisy_sim</th>
      <th>free_sim</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000</th>
      <td>0.00136</td>
      <td>0.00016</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>111</th>
      <td>0.68340</td>
      <td>0.85721</td>
      <td>0.93927</td>
    </tr>
    <tr>
      <th>110</th>
      <td>0.07619</td>
      <td>0.00635</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>011</th>
      <td>0.12967</td>
      <td>0.07411</td>
      <td>0.06073</td>
    </tr>
    <tr>
      <th>101</th>
      <td>0.07366</td>
      <td>0.04401</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>100</th>
      <td>0.00777</td>
      <td>0.00023</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>010</th>
      <td>0.01303</td>
      <td>0.00045</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>001</th>
      <td>0.01492</td>
      <td>0.01748</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can compute the fidelity between the free simulation and Rigetti, as well as the noisy simulation and Rigetti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fidelity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">))</span>


<span class="n">f_free_aspen</span> <span class="o">=</span> <span class="n">fidelity</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;free_sim&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aspen-m-2&quot;</span><span class="p">])</span>
<span class="n">f_noisy_aspen</span> <span class="o">=</span> <span class="n">fidelity</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;noisy_sim&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aspen-m-2&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total fidelity between Aspen-M-2 and noise-free simulator is </span><span class="si">{</span><span class="n">f_free_aspen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total fidelity between Aspen-M-2 and noisy simulator is </span><span class="si">{</span><span class="n">f_noisy_aspen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total fidelity between Aspen-M-2 and noise-free simulator is 0.8899252242353248

Total fidelity between Aspen-M-2 and noisy simulator is 0.9627231692802513
</pre></div>
</div>
</div>
</div>
<p>To better visualize, we can also plot the output probability distributions from each circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Comparing noise-free simulator, noisy simulator, and Aspen-M-2&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;f_free_aspen = </span><span class="si">{</span><span class="n">f_free_aspen</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">f_noise_model_aspen = </span><span class="si">{</span><span class="n">f_noisy_aspen</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/770b0393bd895607f49064bffe3c82c65891c5a08acadeb1eb8b533f3f9e86bc.png" src="../../../_images/770b0393bd895607f49064bffe3c82c65891c5a08acadeb1eb8b533f3f9e86bc.png" />
</div>
</div>
<p>We confirm that the simulator with a noise model is closer to the distribution produced by Aspen-M-2.</p>
</section>
<section id="smaller-reduced-noise-models">
<h2>Smaller, reduced noise models<a class="headerlink" href="#smaller-reduced-noise-models" title="Permalink to this heading">#</a></h2>
<p>The full Rigetti Aspen-M-2 noise model contains due to non-uniform qubit noise. We can obtain simpler, smaller noise models by coarse graining the model above.</p>
<p>Here, we consider taking the average over all qubits for the $T_1$, $T_2$, depolarizing, and readout depolarizing rates. This is a substantially smaller noise model, but may be less accurate.</p>
<p>We use the <code class="docutils literal notranslate"><span class="pre">from_filter</span></code> function to extract all instructions with amplitude dampening noise in the model. We then compute the mean of the error probabilities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">avg_t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">n</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">parameters</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">AmplitudeDamping</span><span class="p">)</span><span class="o">.</span><span class="n">instructions</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">avg_t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">n</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">parameters</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">PhaseDamping</span><span class="p">)</span><span class="o">.</span><span class="n">instructions</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">avg_depo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">n</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">parameters</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">Depolarizing</span><span class="p">)</span><span class="o">.</span><span class="n">instructions</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">avg_readout</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
    <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">parameters</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">noise_model</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">BitFlip</span><span class="p">)</span><span class="o">.</span><span class="n">instructions</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we construct a new noise model with the mean values above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_noise_model</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="p">()</span>
<span class="n">simple_noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">AmplitudeDamping</span><span class="p">(</span><span class="n">avg_t1</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">())</span>
<span class="n">simple_noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">PhaseDamping</span><span class="p">(</span><span class="n">avg_t2</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">())</span>
<span class="n">simple_noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">Depolarizing</span><span class="p">(</span><span class="n">avg_depo</span><span class="p">),</span> <span class="n">GateCriteria</span><span class="p">())</span>
<span class="n">simple_noise_model</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">BitFlip</span><span class="p">(</span><span class="n">avg_readout</span><span class="p">),</span> <span class="n">ObservableCriteria</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">simple_noise_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gate Noise:
  AmplitudeDamping(0.0019483910859341453), GateCriteria(None, None)
  PhaseDamping(0.0018677309884621795), GateCriteria(None, None)
  Depolarizing(0.007153677053977023), GateCriteria(None, None)
Readout Noise:
  BitFlip(0.053481250000000015), ObservableCriteria(None, None)
</pre></div>
</div>
</div>
</div>
<p>We can see the resultant circuits contain qubit-independent noise:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_noisy_circ</span> <span class="o">=</span> <span class="n">simple_noise_model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">simple_noisy_circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T  : |                     0                     |                 1                  |                     2                     |
                                                                                                                                   
q0 : -Rx(0.75)-AD(0.0019)-PD(0.0019)-DEPO(0.0072)-C-AD(0.0019)-PD(0.0019)-DEPO(0.0072)-I--------AD(0.0019)-PD(0.0019)-DEPO(0.0072)-
                                                  |                                                                                
q1 : -I--------AD(0.0019)-PD(0.0019)-DEPO(0.0072)-Z-AD(0.0019)-PD(0.0019)-DEPO(0.0072)-Rx(0.50)-AD(0.0019)-PD(0.0019)-DEPO(0.0072)-
                                                                                                                                   
q2 : -Rz(0.50)-AD(0.0019)-PD(0.0019)-DEPO(0.0072)-I-AD(0.0019)-PD(0.0019)-DEPO(0.0072)-I--------AD(0.0019)-PD(0.0019)-DEPO(0.0072)-

T  : |                     0                     |                 1                  |                     2                     |
</pre></div>
</div>
</div>
</div>
<p>We run the circuit on a noisy simulator below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_noisy_task</span> <span class="o">=</span> <span class="n">noisy_simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">simple_noisy_circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">100_000</span><span class="p">)</span>
<span class="n">simple_noisy_probs</span> <span class="o">=</span> <span class="n">simple_noisy_task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">measurement_probabilities</span>
</pre></div>
</div>
</div>
</div>
<p>and add it to the previous dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_noisy_sim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">simple_noisy_probs</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;simple_noisy_sim&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simple_noisy_sim</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aspen-m-2</th>
      <th>noisy_sim</th>
      <th>free_sim</th>
      <th>simple_noisy_sim</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>000</th>
      <td>0.53302</td>
      <td>0.74544</td>
      <td>0.81380</td>
      <td>0.78149</td>
    </tr>
    <tr>
      <th>100</th>
      <td>0.11748</td>
      <td>0.13151</td>
      <td>0.12486</td>
      <td>0.13176</td>
    </tr>
    <tr>
      <th>010</th>
      <td>0.24681</td>
      <td>0.08706</td>
      <td>0.05338</td>
      <td>0.06130</td>
    </tr>
    <tr>
      <th>110</th>
      <td>0.05687</td>
      <td>0.02742</td>
      <td>0.00796</td>
      <td>0.01061</td>
    </tr>
    <tr>
      <th>011</th>
      <td>0.01819</td>
      <td>0.00055</td>
      <td>NaN</td>
      <td>0.00096</td>
    </tr>
    <tr>
      <th>111</th>
      <td>0.00477</td>
      <td>0.00021</td>
      <td>NaN</td>
      <td>0.00015</td>
    </tr>
    <tr>
      <th>001</th>
      <td>0.01892</td>
      <td>0.00650</td>
      <td>NaN</td>
      <td>0.01179</td>
    </tr>
    <tr>
      <th>101</th>
      <td>0.00394</td>
      <td>0.00131</td>
      <td>NaN</td>
      <td>0.00194</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We compute the fidelity between the simple noise model and the QPU:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_simple</span> <span class="o">=</span> <span class="n">fidelity</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;simple_noisy_sim&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aspen-m-2&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total fidelity between Aspen-M-2 and full noise model is: </span><span class="si">{</span><span class="n">f_noisy_aspen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total fidelity between Aspen-M-2 and simple noise model is: </span><span class="si">{</span><span class="n">f_simple</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total fidelity between Aspen-M-2 and noise-free is: </span><span class="si">{</span><span class="n">f_free_aspen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total fidelity between Aspen-M-2 and full noise model is: 0.9582415634979304

Total fidelity between Aspen-M-2 and simple noise model is: 0.9401126418474742

Total fidelity between Aspen-M-2 and noise-free is: 0.915784824249657
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Comparing simulators and Aspen-M-2&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;f_free = </span><span class="si">{</span><span class="n">f_free_aspen</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">f_simple_noise_model = </span><span class="si">{</span><span class="n">f_simple</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">f_noise_model = </span><span class="si">{</span><span class="n">f_noisy_aspen</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d79fe7236715d0e031f8e4af0759bb653c86c3dc9d00fa32540f64222f995990.png" src="../../../_images/d79fe7236715d0e031f8e4af0759bb653c86c3dc9d00fa32540f64222f995990.png" />
</div>
</div>
<p>We see that compared to the full noise model, the simple model is less accurate, however, it is still a significant improvement over the noise-free case and has far fewer parameters in the model.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>In this notebook, we showed how to construct a noise model for Rigetti Aspen-M-2 based only on the available calibration data.
We used a coarse assumption of gate-independent single-qubit depolarizing noise and gate-dependant two-qubit noise. Our qubit-dependent model could be improved in many ways. We could add gate-dependence noise, or change the depolarizing channel to Pauli channels.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Noise models on Rigetti Aspen-M-2</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a><ul>
<li><a class="reference internal" href="#one-qubit-noise">One-qubit noise</a></li>
<li><a class="reference internal" href="#two-qubit-noise">Two-qubit noise</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compare-circuits-run-on-device-vs-simulator-with-a-noise-model">Compare circuits run on device vs simulator with a noise model</a></li>
<li><a class="reference internal" href="#smaller-reduced-noise-models">Smaller, reduced noise models</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    </body>
</html>