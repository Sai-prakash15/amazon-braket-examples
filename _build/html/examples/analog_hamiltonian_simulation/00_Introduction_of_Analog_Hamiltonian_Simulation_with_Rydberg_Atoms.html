<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Introduction of analog Hamiltonian simulation - Amazon Braket Examples documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Amazon Braket Examples  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Amazon Braket Examples  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  
</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="introduction-of-analog-hamiltonian-simulation">
<h1>Introduction of analog Hamiltonian simulation<a class="headerlink" href="#introduction-of-analog-hamiltonian-simulation" title="Permalink to this heading">#</a></h1>
<p>Analog Hamiltonian Simulation (AHS) is a quantum computing paradigm different from gate-based computing. AHS uses a well-controlled quantum system and tunes its parameters to mimic the dynamics of another quantum system, the one we aim to study.</p>
<p>In the gate-based quantum computation, the program is a quantum circuit consisting of a series of quantum gates, each of which acts only a small subset of qubits. In contrast, an AHS program is a sequence of time-dependent Hamiltonians that govern the quantum dynamics of all qubits. The comparison can be seen in the following figure, where the left side shows a typical quantum circuit, and the right side illustrates that, during AHS, the effect of the evolution under a Hamiltonian can be understood as a unitary acting simultaneously on all qubits.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-center head"><p>Digital quantum circuit</p></th>
<th class="text-center head"><p>Analog Hamiltonian Simulation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><img src="digital.png" alt="digital quantum computing" width="400"/></p></td>
<td class="text-center"><p><img src="analog.png" alt="analog hamiltonian simulation" width="600"/></p></td>
</tr>
</tbody>
</table>
</div>
<p>(“Digital quantum circuit” and “Analog Hamiltonian Simulation” figures by <a class="reference external" href="https://www.quera.com/">QuEra Computing Inc.</a> are licensed under <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>)</p>
<p>In this notebook, we focus on running Analog Hamiltonian Simulations with Rydberg atoms. Also, we will use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> package and <code class="docutils literal notranslate"><span class="pre">ahs_utils.py</span></code> module in the current working directory for visualization purposes.</p>
</section>
<section id="ahs-with-rydberg-atoms">
<h1>AHS with Rydberg atoms<a class="headerlink" href="#ahs-with-rydberg-atoms" title="Permalink to this heading">#</a></h1>
<p>An Analog Hamiltonian Simulation <strong>program</strong> is fully specified by its quantum register and (time-dependent) Hamiltonian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braket.ahs.hamiltonian</span> <span class="kn">import</span> <span class="n">Hamiltonian</span>
<span class="kn">from</span> <span class="nn">braket.ahs.atom_arrangement</span> <span class="kn">import</span> <span class="n">AtomArrangement</span>
<span class="kn">from</span> <span class="nn">braket.ahs.analog_hamiltonian_simulation</span> <span class="kn">import</span> <span class="n">AnalogHamiltonianSimulation</span>

<span class="n">register</span> <span class="o">=</span> <span class="n">AtomArrangement</span><span class="p">()</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">()</span>

<span class="n">ahs_program</span> <span class="o">=</span> <span class="n">AnalogHamiltonianSimulation</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="o">=</span><span class="n">H</span><span class="p">,</span>
    <span class="n">register</span><span class="o">=</span><span class="n">register</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In order to run AHS program with Rydberg atoms, we will first have to understand what type of Hamiltonian can Rydberg atoms simulate.</p>
<section id="introduction-to-rydberg-hamiltonian">
<h2>Introduction to Rydberg Hamiltonian<a class="headerlink" href="#introduction-to-rydberg-hamiltonian" title="Permalink to this heading">#</a></h2>
<p>Depending on the atomic states we use for the Rydberg system, its Hamiltonian could take different forms. Here we shall focus on the following type of Hamiltonian</p>
<p>\begin{align}
H(t) = \sum_{k=1}^N H_{\text{drive}, k}(t) + \sum_{k=1}^N H_{\text{shift}, k}(t) + \sum_{j=1}^{N-1}\sum_{k = j+1}^N H_{\text{vdW}, j, k},
\end{align}</p>
<p>where $j, k=1,2,\ldots N$ index the atoms (qubits) in the program register. We describe the nature and effect of each term in the Hamiltonian in the following sections, using a triangular array as an example.</p>
<section id="register">
<h3>Register<a class="headerlink" href="#register" title="Permalink to this heading">#</a></h3>
<p>First, we need to define a quantum <strong>register</strong>, 2-dimensional layout of neutral atoms, on which this Hamiltonian will act.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># e.g. three atoms in an equilateral triangle, with pairwise</span>
<span class="c1"># separation equal to 5.5 micrometers</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">5.5e-6</span>  <span class="c1"># meters</span>

<span class="n">register</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">register</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">register</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<p>The atom arrangement can be visualized in the following way</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ahs_utils</span> <span class="kn">import</span> <span class="n">show_register</span>

<span class="n">show_register</span><span class="p">(</span><span class="n">register</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/829ac72ad1b446682308b57ca372de5390b5da13131081ff8f2990610b0a47ac.png" src="../../_images/829ac72ad1b446682308b57ca372de5390b5da13131081ff8f2990610b0a47ac.png" />
</div>
</div>
</section>
<section id="driving-field">
<h3>Driving field<a class="headerlink" href="#driving-field" title="Permalink to this heading">#</a></h3>
<p>The first term of the Hamiltonian represents the effect of a <strong>driving field</strong> that addresses the atoms simultaneously and uniformly</p>
<p>\begin{align}
H_{\text{drive}, k}(t) = \frac{\Omega(t)}{2}\left(e^{i\phi(t)}|g_k\rangle\langle r_k| + e^{-i\phi(t)}|r_k\rangle\langle g_k|\right) - \Delta_\text{global}(t)n_k,
\end{align}</p>
<p>where $\Omega$, $\phi$, and $\Delta_\text{global}$ to denote the <strong>amplitude</strong> (Rabi frequency), laser <strong>phase</strong>, and the <strong>detuning</strong> of the driving laser field. Here $n_k = |r_k\rangle\langle r_k|$ is the number operator of atom $k$; the kets $|g_k\rangle$ and $|r_k\rangle$ denote the ground and Rydberg states, respectively. The $\Omega$ part of the driving term is identical to a uniform (time-dependent) <em>transverse</em> magnetic field, whereas the $\Delta_\text{global}$ part implements the effect of a <em>longitudinal</em> magnetic field, in a spin-model representation.</p>
<p>For the purpose of this example, we choose a constant Rabi frequency equal to $\Omega_\text{max}=2.5\times10^6$ rad/s, with the phase and global detuning set to zero. The duration of the program is set to $\frac{\pi}{\sqrt{2}\Omega_\text{max}}$, which will be explained in the next section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braket.timings.time_series</span> <span class="kn">import</span> <span class="n">TimeSeries</span>
<span class="kn">from</span> <span class="nn">braket.ahs.driving_field</span> <span class="kn">import</span> <span class="n">DrivingField</span>

<span class="c1"># e.g. trapzoid amplitude time series</span>
<span class="n">Omega_max</span> <span class="o">=</span> <span class="mf">2.5e6</span>  <span class="c1"># rad / seconds</span>

<span class="c1"># e.g. the duration of the program</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Omega_max</span><span class="p">)</span> <span class="c1"># seconds</span>

<span class="c1"># e.g. constant Rabi frequency</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">()</span>
<span class="n">Omega</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Omega_max</span><span class="p">)</span>
<span class="n">Omega</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">t_max</span><span class="p">,</span> <span class="n">Omega_max</span><span class="p">)</span>

<span class="c1"># e.g. all-zero phase and detuning</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">()</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">t_max</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># (time [s], value [rad])</span>
<span class="n">Delta_global</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">()</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">t_max</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># (time [s], value [rad/s])</span>

<span class="n">drive</span> <span class="o">=</span> <span class="n">DrivingField</span><span class="p">(</span>
    <span class="n">amplitude</span><span class="o">=</span><span class="n">Omega</span><span class="p">,</span>
    <span class="n">phase</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>
    <span class="n">detuning</span><span class="o">=</span><span class="n">Delta_global</span>
<span class="p">)</span>

<span class="n">H</span> <span class="o">+=</span> <span class="n">drive</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="shifting-field">
<h3>Shifting field<a class="headerlink" href="#shifting-field" title="Permalink to this heading">#</a></h3>
<p>The second term in $H(t)$ represents the effect of a <strong>shifting field</strong> that detunes atoms according to a non-uniform pattern.</p>
<p>\begin{align}
H_{\text{shift}, k}(t) = -\Delta_\text{local}(t)h_k ,n_k,
\end{align}</p>
<p>where $\Delta_\text{local}(t)$ is the time-dependent <strong>magnitude</strong> of the frequency shift, and $h_k$ is the atom-dependent <strong>pattern</strong>, which is a dimensionless number between 0 and 1. This shifting term is identical to a non-uniform (and time-dependent) <em>longitudinal</em> magnetic field in a spin-model representation.</p>
<p>For the purpose of this example, we choose a shifting field that strongly detunes the top atom in the triangular lattice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braket.ahs.field</span> <span class="kn">import</span> <span class="n">Field</span>
<span class="kn">from</span> <span class="nn">braket.ahs.pattern</span> <span class="kn">import</span> <span class="n">Pattern</span>
<span class="kn">from</span> <span class="nn">braket.ahs.shifting_field</span> <span class="kn">import</span> <span class="n">ShiftingField</span>

<span class="c1"># e.g. constant strong shifting field</span>
<span class="n">Delta_local</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">()</span>
<span class="n">Delta_local</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="n">Omega_max</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># (time [s], value [rad/s])</span>
<span class="n">Delta_local</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">t_max</span><span class="p">,</span> <span class="o">-</span><span class="n">Omega_max</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>


<span class="c1"># e.g. the shifting field only acts on the third atom, </span>
<span class="c1"># which is the top atom in the triangular array.</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">Pattern</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">shift</span> <span class="o">=</span> <span class="n">ShiftingField</span><span class="p">(</span>
    <span class="n">magnitude</span><span class="o">=</span><span class="n">Field</span><span class="p">(</span>
        <span class="n">time_series</span><span class="o">=</span><span class="n">Delta_local</span><span class="p">,</span>
        <span class="n">pattern</span><span class="o">=</span><span class="n">h</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">H</span> <span class="o">+=</span> <span class="n">shift</span>
</pre></div>
</div>
</div>
</div>
<p>The driving field and the shifting field can be inspected with the following utility function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ahs_utils</span> <span class="kn">import</span> <span class="n">show_drive_and_shift</span>

<span class="n">show_drive_and_shift</span><span class="p">(</span><span class="n">drive</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2b98dd7991971acfee51193b91660077998d21d145fcdc45cfc87f464c29be7f.png" src="../../_images/2b98dd7991971acfee51193b91660077998d21d145fcdc45cfc87f464c29be7f.png" />
</div>
</div>
</section>
<section id="rydberg-rydberg-interaction">
<h3>Rydberg-Rydberg interaction<a class="headerlink" href="#rydberg-rydberg-interaction" title="Permalink to this heading">#</a></h3>
<p>Finally, the third term in $H(t)$ is the van der Waals interaction between all pairs of Rydberg atoms,</p>
<p>\begin{align}
H_{\text{vdW}, j, k} =V_{j,k} ,n_j, n_k = \frac{C_6}{R_{j,k}^6} ,n_j, n_k,
\end{align}</p>
<p>where $C_6$ is a fixed interaction coefficient, and $R_{j,k}=|{\bf x}_j-{\bf x}<em>k|$ is the distance between atoms $j$ and $k$. This interaction shifts the frequency of the Rydberg level of all atoms that are close to an atom that is already in its Rydberg state. While the overall coefficient, $C_6$ is a fixed value (determined by the nature of the ground and Rydberg states), the strength of this interaction can be tuned by adjusting the pairwise distance $R</em>{j,k}$ between atoms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note:</span>
<span class="c1"># The van der Waals interaction term is implicitly assumed in the current version of the AHS module,</span>
<span class="c1"># its strength (C6 / R_{j,k}^6) is calculated (if using the local simulator) from the atomic positions </span>
<span class="c1"># of the register, hence there is no need to specify it explicitly.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Introduction to Rydberg blockade</strong></p>
<p>For the interaction coefficient, the value of $C_6$ depends on the atom species, and the states used in the simulation. Here we shall take the value</p>
<p>\begin{align}
C_6 = 5.42\times 10^{-24} ~\text{rad}~ \text{m}^6/\text{s}
\end{align}</p>
<p>for $|r\rangle = |70S_{1/2}\rangle$ of the $^{87}$Rb atoms. For the typical scenario, where atoms are separated by $4\times10^{-6}$ meters, the van der Waals interaction strength is $V_{jk}=1.32\times10^9 \text{rad}/\text{s}$, which is much larger than the typical scale of the Rabi frequency (around $6\times10^6 \text{rad}/\text{s}$). As a result, when the separation of two atoms is within certain distance, it is nearly impossible to drive them to the Rydberg state simultaneously.</p>
<p>This is called the Rydberg blockade phenomena, illustrated in the figure below (Source: <a class="reference external" href="https://arxiv.org/abs/2002.07413">Browaeys and Lahaye</a>), where $R$ is the separation between the atoms, and $E$ indicates the energies or frequencies of the different two-atom states as $R$ changes. The vertical arrows indicate the effect of a uniform driving field (with Rabi frequency $\Omega$) that successfully transitions the atoms from the $|gg\rangle$ ground state to the 1-atom excited state $|\psi_+\rangle = (|gr\rangle + |rg\rangle)/\sqrt{2}$ (independent of $R$), but fails to get from there to the doubly-excited state $|rr\rangle$, if $R$ is smaller than $R_b = (C_6 / \Omega)^{1/6}$, the blockade radius.</p>
<p><u>Note</u>: In the presence of both global Rabi frequency and detuning, it is more accurate to estimate the blockade radius with $R_b = (C_6 / \sqrt{\Omega^2+\Delta^2})^{1/6}$, see <a class="reference external" href="https://arxiv.org/abs/1808.10816">Pichler, et. al.</a>.</p>
<img src="Blockade.png" alt="drawing" style="width:250px;"/></section>
<section id="full-program">
<h3>Full program<a class="headerlink" href="#full-program" title="Permalink to this heading">#</a></h3>
<p>The fully-specified program can be inspected with the following command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ahs_program</span><span class="o">.</span><span class="n">to_ir</span><span class="p">()</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;braketSchemaHeader&#39;: {&#39;name&#39;: &#39;braket.ir.ahs.program&#39;, &#39;version&#39;: &#39;1&#39;},
 &#39;setup&#39;: {&#39;ahs_register&#39;: {&#39;sites&#39;: [[Decimal(&#39;0&#39;), Decimal(&#39;0&#39;)],
    [Decimal(&#39;0.0000055&#39;), Decimal(&#39;0.0&#39;)],
    [Decimal(&#39;0.00000275&#39;), Decimal(&#39;0.000004763139720814412&#39;)]],
   &#39;filling&#39;: [1, 1, 1]}},
 &#39;hamiltonian&#39;: {&#39;drivingFields&#39;: [{&#39;amplitude&#39;: {&#39;time_series&#39;: {&#39;values&#39;: [Decimal(&#39;2500000.0&#39;),
       Decimal(&#39;2500000.0&#39;)],
      &#39;times&#39;: [Decimal(&#39;0.0&#39;), Decimal(&#39;8.885765876316732E-7&#39;)]},
     &#39;pattern&#39;: &#39;uniform&#39;},
    &#39;phase&#39;: {&#39;time_series&#39;: {&#39;values&#39;: [Decimal(&#39;0.0&#39;), Decimal(&#39;0.0&#39;)],
      &#39;times&#39;: [Decimal(&#39;0.0&#39;), Decimal(&#39;8.885765876316732E-7&#39;)]},
     &#39;pattern&#39;: &#39;uniform&#39;},
    &#39;detuning&#39;: {&#39;time_series&#39;: {&#39;values&#39;: [Decimal(&#39;0.0&#39;), Decimal(&#39;0.0&#39;)],
      &#39;times&#39;: [Decimal(&#39;0.0&#39;), Decimal(&#39;8.885765876316732E-7&#39;)]},
     &#39;pattern&#39;: &#39;uniform&#39;}}],
  &#39;shiftingFields&#39;: [{&#39;magnitude&#39;: {&#39;time_series&#39;: {&#39;values&#39;: [Decimal(&#39;-50000000.0&#39;),
       Decimal(&#39;-50000000.0&#39;)],
      &#39;times&#39;: [Decimal(&#39;0.0&#39;), Decimal(&#39;8.885765876316732E-7&#39;)]},
     &#39;pattern&#39;: [Decimal(&#39;0&#39;), Decimal(&#39;0&#39;), Decimal(&#39;0.5&#39;)]}}]}}
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="running-ahs-program-with-local-simulator">
<h1>Running AHS program with local simulator<a class="headerlink" href="#running-ahs-program-with-local-simulator" title="Permalink to this heading">#</a></h1>
<p>The AHS program defined above realizes the maximally entangled state for a pair of atoms, out of the three atoms in the triangular array. To see that, recall that we have subjected the top atom in the triangular array (labeled as atom 2) with a strong detuning $H_{\text{shift}, 2}(t) = -\frac{1}{2}\Delta_\text{local}n_2$ where $\Delta_\text{local}=-10\Omega_\text{max}=-2.5\times10^7$ rad/s. Since $\Delta_\text{local}$ is much bigger than any other energy scales in the system, including the Rabi frequency, it is energy unfavorable for atom 2 to be excited to the Rydberg state (note the minus sign in $H_{\text{shift}, 2}(t)$). Hence atom 2 remains in the ground state throughout the evolution, and can be neglected in the following analysis.</p>
<p>Since the other two atoms are subjected with only the driving field with zero detuning and phase, the constant Hamiltonian reads
\begin{align}
H = \frac{\Omega}{2}\sum_{k=0}^1\left(|g_k\rangle\langle r_k| + |r_k\rangle\langle g_k|\right) + V_{0,1}{n}<em>0{n}<em>1,
\end{align}
where $k=0,1$ are the indices for the two lower atoms in the triangular array. More concretely, in the basis of $\left{|gg\rangle, |gr\rangle, |rg\rangle, |rr\rangle\right}$, the Hamiltonian takes the following matrix representation
\begin{align}
H =
\begin{bmatrix}
0 &amp; \frac{\Omega}{2} &amp; \frac{\Omega}{2} &amp; 0 \
\frac{\Omega}{2} &amp; 0 &amp; 0 &amp; \frac{\Omega}{2}\
\frac{\Omega}{2} &amp; 0 &amp; 0 &amp; \frac{\Omega}{2}\
0 &amp; \frac{\Omega}{2} &amp; \frac{\Omega}{2} &amp; V</em>{0,1}
\end{bmatrix}.
\end{align}
Since the two atoms are separated by $d</em>{0,1} = 5.5\times10^{-6}$ meters, the interaction strength between them reads
\begin{align}
V_{0,1}=\frac{C_6}{(d_{0,1})^6} = \frac{5.42\times10^{-24}}{(5.5\times10^{-6})^6}\approx1.96\times10^8 \text{ rad/s},
\end{align}
which is much greater than the Rabi frequency. Hence the two atoms are in the Rydberg blockade regime, and the state $|rr\rangle$ is very unlikely to be excited (assuming the initial state is $|gg\rangle$). Hence we can neglect the $|rr\rangle$ state, and the Hamiltonian is simplified to be
\begin{align}
H =
\begin{bmatrix}
0 &amp; \frac{\Omega}{2} &amp; \frac{\Omega}{2} \
\frac{\Omega}{2} &amp; 0 &amp; 0 \
\frac{\Omega}{2} &amp; 0 &amp; 0
\end{bmatrix},
\end{align}
and the final state of the evolution can be solved to be
\begin{align}
|\psi\rangle = e^{-iHt}|gg\rangle =
\begin{bmatrix}
\cos\frac{\Omega t}{\sqrt{2}}\
\frac{i}{\sqrt{2}}\sin\frac{\Omega t}{\sqrt{2}}\
\frac{i}{\sqrt{2}}\sin\frac{\Omega t}{\sqrt{2}}
\end{bmatrix}.
\end{align}
Hence if the system evolves for a duration $T=\frac{\pi}{\sqrt{2}\Omega}$, which is indeed the duration of the AHS program defined in the previous section, we will arrive at a maximally entangled state between the two atoms
\begin{align}
|\psi\rangle = \frac{1}{\sqrt{2}}(|gr\rangle+|rg\rangle).
\end{align}</p>
<p>Before submitting the AHS program to a QPU, it is useful to run the program on the local simulator to check if the simulation result meets one’s expectation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">braket.devices</span> <span class="kn">import</span> <span class="n">LocalSimulator</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">LocalSimulator</span><span class="p">(</span><span class="s2">&quot;braket_ahs&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can run the AHS program just like running a quantum circuit on other Braket devices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ahs_program</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To confirm that we indeed arrive at a maximally entangled state, we first collect the measurement results, followed by counting the number of occurrence of $|gr\rangle$ and $|rg\rangle$ respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_counters_from_result</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="n">post_sequences</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">measurement</span><span class="o">.</span><span class="n">post_sequence</span><span class="p">)</span> <span class="k">for</span> <span class="n">measurement</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">measurements</span><span class="p">]</span>
    <span class="n">post_sequences</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">site</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;g&#39;</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">post_sequence</span><span class="p">])</span> <span class="k">for</span> <span class="n">post_sequence</span> <span class="ow">in</span> <span class="n">post_sequences</span><span class="p">]</span>

    <span class="n">counters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">post_sequence</span> <span class="ow">in</span> <span class="n">post_sequences</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">post_sequence</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">:</span>
            <span class="n">counters</span><span class="p">[</span><span class="n">post_sequence</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">counters</span><span class="p">[</span><span class="n">post_sequence</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counters</span>

<span class="n">get_counters_from_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ggr&#39;: 1, &#39;grg&#39;: 484, &#39;rgg&#39;: 515}
</pre></div>
</div>
</div>
</div>
<p>The simulation outcome indeed confirms our expectations</p>
<ol class="arabic simple">
<li><p>It is very unlikely to excite the 3rd atom to the Rydberg state because of the strong local detuning.</p></li>
<li><p>Due to the Rydberg blockade, it is very unlikely to excite the 1st and 2nd atoms to the Rydberg states simultaneously.</p></li>
<li><p>By appropriately tuning the Rabi frequency and the duration of the AHS program, we can arrive at a maximally entangled state for the 1st and 2nd atoms. Since our simulation is noiseless, the discrepancy from ideal 50%-50% split is attributed to statistical sampling (aka “shot noise”).</p></li>
</ol>
<p>In summary, in this notebook, we have introduced Analog Hamiltonian Simulation (AHS), a different quantum computing paradigm, and showed how to run an AHS program with Rydberg atoms using Braket’s local AHS simulator.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>