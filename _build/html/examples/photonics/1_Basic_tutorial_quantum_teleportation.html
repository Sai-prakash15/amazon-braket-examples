<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Basic tutorial: quantum teleportation - Amazon Braket Examples documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Amazon Braket Examples  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Amazon Braket Examples  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting_started_index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/0_Getting_started/0_Getting_started.html">Getting started with Amazon Braket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/1_Running_quantum_circuits_on_simulators/1_Running_quantum_circuits_on_simulators.html">Preparing a GHZ state and running the circuit on simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/2_Running_quantum_circuits_on_QPU_devices/2_Running_quantum_circuits_on_QPU_devices.html">Running quantum circuits on QPU devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/2_Running_quantum_circuits_on_QPU_devices/2_Running_quantum_circuits_on_QPU_devices.html#appendix">APPENDIX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/3_Deep_dive_into_the_anatomy_of_quantum_circuits/3_Deep_dive_into_the_anatomy_of_quantum_circuits.html">Anatomy of Quantum Circuits and Quantum Tasks in Amazon Braket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/4_Superdense_coding/4_Superdense_coding.html">Superdense Coding</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../braket_features_index.html">Braket Features</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../braket_features/Getting_Devices_and_Checking_Device_Properties.html">Getting Devices and Checking Device Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../braket_features/Getting_Started_with_OpenQASM_on_Braket.html">Getting Started with OpenQASM on Braket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../braket_features/Getting_Started_with_OpenQASM_on_Braket.html#openqasm-features-on-braket">OpenQASM features on Braket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../braket_features/Getting_Started_with_OpenQASM_on_Braket.html#conclusion">Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../braket_features/Simulating_Advanced_OpenQASM_Programs_with_the_Local_Simulator.html">Simulating Advanced OpenQASM Programs with the Local Simulator</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section id="basic-tutorial-quantum-teleportation">
<h1>Basic tutorial: quantum teleportation<a class="headerlink" href="#basic-tutorial-quantum-teleportation" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>“A trick that quantum magicians use to produce phenomena that cannot be imitated by classical magicians.” -  A. Peres [1].</p>
</div></blockquote>
<p>To see how to construct and simulate a simple continuous-variable (CV) quantum circuit in Strawberry
Fields, let’s consider the case of <strong>state teleportation</strong>.</p>
<section id="background-theory">
<h2>Background theory<a class="headerlink" href="#background-theory" title="Permalink to this heading">#</a></h2>
<p>Quantum teleportation - sometimes referred to as state teleportation to avoid confusion
with gate teleportation - is the reliable transfer of an unknown quantum state across
spatially separated qubits or qumodes, through the use of a classical transmission channel
and quantum entanglement [2]. Considered a fundamental quantum information
protocol, it has applications ranging from quantum communication to enabling distributed
information processing in quantum computation [3].</p>
<p>In general, all quantum teleportation circuits work on the same basic principle. Two
distant observers, Alice and Bob, share a maximally entangled quantum state (in discrete
variables, any one of the four <a class="reference external" href="https://en.wikipedia.org/wiki/Bell_state">Bell states</a>;
or in CV, a maximally entangled state for a fixed energy), and have access to a classical
communication channel. Alice, in possession of an unknown state which she wishes to
transport to Bob, makes a joint measurement of the unknown state and her half of the
entangled state, by projecting onto the Bell basis. By transmitting the results of her
measurement to Bob, Bob is then able to transform his half of the entangled state to
an accurate replica of the original unknown state, by performing a conditional phase
flip (for qubits) or displacement (for qumodes) [4].</p>
<p>While originally designed for discrete-variable quantum computation with qubits, the
(spatially separated) quantum teleportation algorithm described above can be easily
translated to CV qumodes; the result is shown in the following circuit:</p>
<p><img alt="teleport.png" src="examples/photonics/attachment:teleport.png" /></p>
<p>This process can be explained as follows:</p>
<ol class="arabic simple">
<li><p>Here, qumodes $q_1$ and $q_2$ are initially prepared as (the unphysical)
infinitely squeezed vacuum states in momentum and position space respectively,</p></li>
</ol>
<p>$$
\newcommand{\ket}[1]{\left|{#1}\right\rangle}
\newcommand{\bra}[1]{\left\langle{#1}\right|}
\begin{align*}
&amp;\ket{0}<em>x \sim \lim</em>{z\rightarrow\infty} S(z)\ket{0} \
&amp;\ket{0}<em>p \sim \lim</em>{z\rightarrow-\infty} S(z)\ket{0}=\frac{1}{\sqrt{\pi}}\int_{-\infty}^\infty \ket{x}~dx
\end{align*}
$$</p>
<p>before being maximally entangled by a 50-50 beamsplitter:</p>
<p>$$
BS(\pi/4,0)(\ket{0}_p\otimes\ket{0}_x)
$$</p>
<ol class="arabic simple" start="2">
<li><p>These two qumodes are now spatially separated, with $\ket{q_1}$ held by
Alice, and $\ket{q_2}$ held by Bob, with the two connected via the classical
communication channels $c_0$ and $c_1$.</p></li>
<li><p>To teleport her unknown state $\ket{\psi}$ to Bob, Alice now performs a projective
measurement of her entire system onto the maximally entangled basis states. This is done
by entangling $\ket{\psi}$ and $\ket{q_1}$ via another 50-50 beamsplitter,
before performing two homodyne measurements, in the $x$ and $p$ quadratures respectively.</p></li>
<li><p>The results of these measurements are then transmitted to Bob, who performs both a
position displacement (conditional on the $x$ measurement) and a momentum
displacement (conditional on the $p$ measurement) to recover exactly the
transmitted state $\ket{\psi}$.</p></li>
</ol>
</section>
<section id="importing-strawberry-fields">
<h2>Importing Strawberry Fields<a class="headerlink" href="#importing-strawberry-fields" title="Permalink to this heading">#</a></h2>
<p>The first thing we need to do is import Strawberry Fields; we do this with the following import
statements:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">strawberryfields</span> <span class="k">as</span> <span class="nn">sf</span>
<span class="kn">from</span> <span class="nn">strawberryfields.ops</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>

<span class="c1"># set the random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The first import statement imports Strawberry Fields as <code class="docutils literal notranslate"><span class="pre">sf</span></code>, allowing us to access the engine
and backends; the second import statement imports all available CV gates into the global
namespace. Finally, we import $\pi$ and the square root from <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> so that we can pass angle
parameters to gates such as beamsplitters, and perform some custom classical processing.</p>
</section>
<section id="program-initialization">
<h2>Program initialization<a class="headerlink" href="#program-initialization" title="Permalink to this heading">#</a></h2>
<p>We can now initialize our quantum program by instantiating a <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Program.html"><code class="docutils literal notranslate"><span class="pre">Program</span></code></a> class:</p>
<p><code class="docutils literal notranslate"><span class="pre">sf.Program(num_subsystems,</span> <span class="pre">name=None)</span></code></p>
<p>where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_subsystems</span></code> (<em>int</em>) is the number of modes we want to initialize in our quantum register</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (<em>str</em>) is the name of the program (optional)</p></li>
</ul>
<blockquote>
<div><p><strong>Note:</strong> By default, Strawberry Fields uses the convention $\hbar=2$ for the commutation relation $[\hat{x},\hat{p}]=i\hbar$. Other conventions can also be chosen by setting the global variable <code class="docutils literal notranslate"><span class="pre">sf.hbar</span></code> at the beginning of a session.
The value of $\hbar$ chosen modifies the application of the <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.ops.Xgate.html"><code class="docutils literal notranslate"><span class="pre">Xgate</span></code></a> and <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.ops.Zgate.html"><code class="docutils literal notranslate"><span class="pre">Zgate</span></code></a>, as well as the
measurements returned by Homodyne measurement <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.ops.MeasureHomodyne.html"><code class="docutils literal notranslate"><span class="pre">MeasureHomodyne</span></code></a>, so this must be taken into account if the value of $\hbar$ is modified. All other gates are
unaffected. See <a class="reference external" href="https://strawberryfields.ai/photonics/conventions/index.html#conventions">Conventions and formulas</a> for more details.</p>
</div></blockquote>
<p>Therefore, to initialize a program on three quantum registers, we write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prog</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Program</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="circuit-construction">
<h2>Circuit construction<a class="headerlink" href="#circuit-construction" title="Permalink to this heading">#</a></h2>
<p>To prepare states and apply gates to the quantum register <code class="docutils literal notranslate"><span class="pre">q</span></code>, we must be inside the context of
the program we initialized using the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement. Everything within the program context is
written using the <a class="reference external" href="https://strawberryfields.ai/photonics/demos/run_blackbird.html#blackbird">Blackbird quantum programming language</a>. For example, to
construct the following state teleportation circuit</p>
<p><img alt="" src="examples/photonics/teleport.png" /></p>
<p>to teleport the coherent state $\ket{\alpha}$ where $\alpha=1+0.5i$:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="n">j</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

<span class="k">with</span> <span class="n">prog</span><span class="o">.</span><span class="n">context</span> <span class="k">as</span> <span class="n">q</span><span class="p">:</span>
    <span class="c1"># prepare initial states</span>
    <span class="n">Coherent</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Squeezed</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Squeezed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># apply gates</span>
    <span class="n">BS</span> <span class="o">=</span> <span class="n">BSgate</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
    <span class="n">BS</span> <span class="o">|</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">BS</span> <span class="o">|</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Perform homodyne measurements</span>
    <span class="n">MeasureX</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">MeasureP</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Displacement gates conditioned on</span>
    <span class="c1"># the measurements</span>
    <span class="n">Xgate</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">par</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Zgate</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">par</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>A couple of things to note here:</p>
<ul>
<li><p><strong>The quantum register returned from the</strong> <code class="docutils literal notranslate"><span class="pre">prog.context</span></code> <strong>context manager is a sequence</strong>.
Individual modes can be accessed via standard Python indexing and slicing techniques.</p></li>
<li><p><strong>Preparing initial states, measurements, and gate operations all make use of the following
syntax:</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Operation([arg1,</span> <span class="pre">arg2,</span> <span class="pre">...])</span> <span class="pre">|</span> <span class="pre">reg</span></code></p>
<p>where the number of arguments depends on the specific operation, and <code class="docutils literal notranslate"><span class="pre">reg</span></code> is either a
single mode or a sequence of modes, depending on how many modes the operation acts on. For a full
list of operations and gates available, see the <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/sf_ops.html#gates">quantum gates</a> documentation.</p>
</li>
<li><p><strong>Every time a operation is applied it is added to the command queue</strong>, ready to be simulated by
the backend.</p></li>
<li><p><strong>Operations must be applied in temporal order</strong>. Different operation orderings can result in the
same quantum circuit, providing the operations do not apply sequentially to the same mode. For
example, we can permute the line containing <code class="docutils literal notranslate"><span class="pre">MeasureX</span></code> and <code class="docutils literal notranslate"><span class="pre">MeasureP</span></code> without changing the
result.</p></li>
<li><p><strong>Gates are standard Python objects, and can be treated as such</strong>. In this case, since both
beamsplitters use the same parameters, a single instance is being instantiated and stored under
variable <code class="docutils literal notranslate"><span class="pre">BS</span></code>.</p></li>
<li><p><strong>The results of measured modes are passed to gates simply by passing the measured mode as an
argument.</strong> In order to perform additional classical processing to the measured mode <code class="docutils literal notranslate"><span class="pre">q[i]</span></code>, and
use the result to control a subsequent quantum operation, we can use the <code class="docutils literal notranslate"><span class="pre">q[i].par</span></code> attribute
within the operation argument.</p></li>
</ul>
<blockquote>
<div><p><strong>Note:</strong> By choosing a different phase for the 50-50 beamsplitter, that is, <code class="docutils literal notranslate"><span class="pre">BSgate(pi/4,0)</span></code>, we can avoid having to negate the <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.ops.Zgate.html"><code class="docutils literal notranslate"><span class="pre">Zgate</span></code></a> correction at the end of the circuit.</p>
</div></blockquote>
</section>
<section id="executing-the-program">
<h2>Executing the program<a class="headerlink" href="#executing-the-program" title="Permalink to this heading">#</a></h2>
<p>Once the program is constructed, we then must initialize an <strong>engine</strong>, which is responsible for
executing the program on a specified <strong>backend</strong> (which can be either a local simulator, or a
remote simulator/hardware device). Engines are initialized as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">sf.Engine(backend,</span> <span class="pre">backend_options={})</span></code></p>
<p>where</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">backend</span></code>: a string or <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseBackend.html"><code class="docutils literal notranslate"><span class="pre">BaseBackend</span></code></a> object representing the Strawberry Fields backend we wish to use; we have the choice of two Fock backends [5], the NumPy based (<code class="docutils literal notranslate"><span class="pre">'fock'</span></code>) and TensorFlow (<code class="docutils literal notranslate"><span class="pre">'tf'</span></code>), and one Gaussian backend [6] (<code class="docutils literal notranslate"><span class="pre">'gaussian'</span></code>).</p>
<p>This argument is <em>required</em> when creating the engine.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">backend_options</span></code> is a dictionary containing options specific to the chosen backend.</p></li>
</ul>
<p>Let’s choose the Fock backend for this particular example. Since we are working in the Fock basis,
we must also specify the Fock basis <em>cutoff dimension</em>; let’s choose <code class="docutils literal notranslate"><span class="pre">cutoff_dim=15</span></code>, such that
a state $\ket{\psi}$ has approximation</p>
<p>$$
\ket{\psi} = \sum_{n=0}^\infty c_n\ket{n} \approx \sum_{n=0}^{\texttt{cutoff}_\texttt{dim}-1} c_n\ket{n}
$$</p>
<p>in our truncated Fock basis. We now have all the parameters ready to initialize the engine:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eng</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Engine</span><span class="p">(</span><span class="s1">&#39;fock&#39;</span><span class="p">,</span> <span class="n">backend_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cutoff_dim&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Warning:</strong> To avoid significant numerical error when working with the Fock backend, we need to make sure from now on that all initial states and gates we apply result in negligible amplitude in the Fock basis for Fock states $\ket{n}, ~~n\geq \texttt{cutoff}_\texttt{dim}$. For example, to prepare a squeezed vacuum state in the $x$ quadrature with <code class="docutils literal notranslate"><span class="pre">cutoff_dim=10</span></code>, a     squeezing factor of $r=1$ provides an acceptable approximation, since $|\langle n \vert z \rangle|^2 &lt; 0.02$ for $n\geq 10$.</p>
</div></blockquote>
<p>We can now execute our quantum program <code class="docutils literal notranslate"><span class="pre">prog</span></code> on the engine via the <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Engine.html#strawberryfields.Engine.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">eng</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">modes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compile_options</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Engine.html#strawberryfields.Engine.run"><code class="docutils literal notranslate"><span class="pre">eng.run</span></code></a> method accepts the arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">program</span></code>: The <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Program.html"><code class="docutils literal notranslate"><span class="pre">Program</span></code></a> to execute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shots</span></code>: A positive integer that specifies the number of times the program measurement
evaluation is to be repeated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modes</span></code>: An optional list of integers that specifies which modes we wish the backend to
return for the quantum state. If the state is a mixed state represented by a density matrix,
then the backend will automatically perform a partial trace to return only the modes
specified. Note that this only affects the returned state object—all modes remain in the
backend circuit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compile_options</span></code>: A dictionary of keyword arguments to be used for program compilation. To
ensure the <code class="docutils literal notranslate"><span class="pre">~strawberryfields.Program</span></code> will run on the specified backend, the engine will
perform <strong>program compilation</strong>, by calling the <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Program.html#strawberryfields.Program.compile"><code class="docutils literal notranslate"><span class="pre">compile()</span></code></a> method.</p></li>
</ul>
<blockquote>
<div><p><strong>Note:</strong> A <code class="docutils literal notranslate"><span class="pre">shots</span></code> value different than 1 is currently only supported for one specific case: the <code class="docutils literal notranslate"><span class="pre">MeasureFock/Measure</span></code> operation executed on the Gaussian backend.</p>
</div></blockquote>
<p>Other useful engine methods that can be called at any time include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.engine.BaseEngine.html#strawberryfields.engine.BaseEngine.print_applied"><code class="docutils literal notranslate"><span class="pre">eng.print_applied()</span></code></a>: Prints all commands applied using <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.engine.LocalEngine.html#strawberryfields.engine.LocalEngine.run"><code class="docutils literal notranslate"><span class="pre">eng.run</span></code></a> since the last backend reset/initialisation.</p>
<ul>
<li><p>This may differ from your original constructed program due to program compilation. As a
result, this shows all applied gate decompositions, which may differ depending on the backend.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.engine.BaseEngine.html#strawberryfields.engine.BaseEngine.reset"><code class="docutils literal notranslate"><span class="pre">eng.reset()</span></code></a>: Resets the backend circuit to the vacuum state.</p></li>
</ul>
</section>
<section id="results-and-visualization">
<h2>Results and visualization<a class="headerlink" href="#results-and-visualization" title="Permalink to this heading">#</a></h2>
<p>The returned <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Result.html"><code class="docutils literal notranslate"><span class="pre">Result</span></code></a> object provides several useful properties for accessing the results of your program execution:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">result.state</span></code>: The quantum state object contains details and methods for manipulation of the
final circuit state.</p>
<p>Note that only local simulators will return a state object. Remote simulators and hardware
backends will return measurement <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Result.html#strawberryfields.Result.samples"><code class="docutils literal notranslate"><span class="pre">sample</span></code></a>, but the return value of <code class="docutils literal notranslate"><span class="pre">state</span></code> will be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Depending on backend used, the state returned might be a <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseFockState.html"><code class="docutils literal notranslate"><span class="pre">BaseFockState</span></code></a>, which represents the state using the
Fock/number basis, or might be a <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseGaussianState.html"><code class="docutils literal notranslate"><span class="pre">BaseGaussianState</span></code></a>, which represents the state using Gaussian representation, as a vector of means and a covariance
matrix. Many methods are provided for state manipulation, see <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/introduction/states.html">States</a> for more details.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">result.samples</span></code>: Measurement samples from any measurements performed. Returned measurement
samples will have shape <code class="docutils literal notranslate"><span class="pre">(shots,</span> <span class="pre">modes)</span></code>.</p></li>
</ul>
<p>Once the engine has been run, we can extract results of measurements and the quantum state from
the circuit. Any measurements performed on a mode are stored attribute <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.Result.html#strawberryfields.Result.samples"><code class="docutils literal notranslate"><span class="pre">result.samples</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.19890199 0.17330173]]
</pre></div>
</div>
</div>
</div>
<p>If a mode has not been measured, this attribute simply returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>In this particular example, we are using the Fock backend, and so the state that was returned by
<code class="docutils literal notranslate"><span class="pre">result.state</span></code> is in the Fock basis. To double check this, we can inspect it with the <code class="docutils literal notranslate"><span class="pre">print</span></code>
function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">state</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;FockState: num_modes=3, cutoff=15, pure=False, hbar=2&gt;
</pre></div>
</div>
</div>
</div>
<p>In addition to the parameters we have already configured when creating and running the engine, the
line <code class="docutils literal notranslate"><span class="pre">pure=False</span></code>, indicates that this is a mixed state represented as a density matrix, and not
a state vector.</p>
<p>To return the density matrix representing the Fock state, we can use the method <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseFockState.html#strawberryfields.backends.BaseFockState.dm"><code class="docutils literal notranslate"><span class="pre">state.dm</span></code></a> [7]. In this case, the density matrix has dimension</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">dm</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15, 15, 15, 15, 15, 15)
</pre></div>
</div>
</div>
</div>
<p>Here, we use the convention that every pair of consecutive dimensions corresponds to a subsystem;
i.e.,</p>
<p>$$
\rho_{\underbrace{ij}<em>{q[0]}~\underbrace{kl}</em>{q[1]}~\underbrace{mn}_{q[2]}}
$$</p>
<p>Thus we can calculate the reduced density matrix for mode <code class="docutils literal notranslate"><span class="pre">q[2]</span></code>, $\rho_2$:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kkllij-&gt;ij&#39;</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">dm</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rho2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15, 15)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> The Fock state also provides the method <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseFockState.html#strawberryfields.backends.BaseFockState.reduced_dm"><code class="docutils literal notranslate"><span class="pre">reduced_dm()</span></code></a> for extracting the reduced density matrix automatically.</p>
</div></blockquote>
<p>The diagonal values of the reduced density matrix contain the marginal Fock state probabilities
$|\langle i \vert \rho_2 \rangle|^2,~~ 0\leq i\leq 14$:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real_if_close</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">rho2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.10694907e-01 3.62467630e-01 2.11807608e-01 8.23802050e-02
 2.43874177e-02 5.83556629e-03 1.26776314e-03 2.37656289e-04
 8.43934922e-05 1.78787082e-06 1.52342119e-04 1.07036413e-05
 3.36055927e-04 1.47426072e-05 1.92773805e-04]
</pre></div>
</div>
</div>
</div>
<p>We can then use a package such as matplotlib to plot the marginal Fock state probability
distributions for the first 6 Fock states, for the teleported mode <code class="docutils literal notranslate"><span class="pre">q[2]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">probs</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fock state&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Marginal probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mode 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/af9433dc69a6925aa72193b388faf29ee8aec379c143b3d4c465b29cc0c274f1.png" src="../../_images/af9433dc69a6925aa72193b388faf29ee8aec379c143b3d4c465b29cc0c274f1.png" />
</div>
</div>
<p>Note that this information can also be extracted automatically via the Fock state method <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseFockState.html#strawberryfields.backends.BaseFockState.all_fock_probs"><code class="docutils literal notranslate"><span class="pre">all_fock_probs()</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fock_probs</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">all_fock_probs</span><span class="p">()</span>
<span class="n">fock_probs</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fock_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.10694907e-01 3.62467630e-01 2.11807608e-01 8.23802050e-02
 2.43874177e-02 5.83556629e-03 1.26776314e-03 2.37656289e-04
 8.43934922e-05 1.78787082e-06 1.52342119e-04 1.07036413e-05
 3.36055927e-04 1.47426072e-05 1.92773805e-04]
</pre></div>
</div>
</div>
</div>
</section>
<section id="full-program">
<h2>Full program<a class="headerlink" href="#full-program" title="Permalink to this heading">#</a></h2>
<p>The full Strawberry Fields program for teleportation is given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">strawberryfields</span> <span class="k">as</span> <span class="nn">sf</span>
    <span class="kn">from</span> <span class="nn">strawberryfields.ops</span> <span class="kn">import</span> <span class="o">*</span>

    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>

    <span class="n">prog</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Program</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="n">j</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">prog</span><span class="o">.</span><span class="n">context</span> <span class="k">as</span> <span class="n">q</span><span class="p">:</span>
        <span class="c1"># prepare initial states</span>
        <span class="n">Coherent</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Squeezed</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Squeezed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># apply gates</span>
        <span class="n">BS</span> <span class="o">=</span> <span class="n">BSgate</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
        <span class="n">BS</span> <span class="o">|</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">BS</span> <span class="o">|</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Perform homodyne measurements</span>
        <span class="n">MeasureX</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">MeasureP</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Displacement gates conditioned on</span>
        <span class="c1"># the measurements</span>
        <span class="n">Xgate</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">par</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Zgate</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">par</span><span class="p">)</span> <span class="o">|</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">eng</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">Engine</span><span class="p">(</span><span class="s1">&#39;fock&#39;</span><span class="p">,</span> <span class="n">backend_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cutoff_dim&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">eng</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">prog</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">modes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compile_options</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
</section>
<section id="footnotes">
<h2>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this heading">#</a></h2>
<p>[5] Fock backends are backends which represent the quantum state and operations via the Fock basis. These can represent <em>all</em> possible CV states and operations, but also introduce numerical error due to truncation of the Fock space, and consume more memory.</p>
<p>[6] The Gaussian backend, due to its ability to represent states and operations as Gaussian
objects/transforms in the phase space, consumes less memory and is less computationally intensive
then the Fock backends. However, it cannot represent non-Gaussian operations and states (such as
the cubic phase gate, and Fock states, amongst others). The only exception is Fock measurements.
The Gaussian backend can simulate these, but it does not update the post-measurement quantum
state, which would be non-Gaussian.</p>
<p>[7] If using the Gaussian backend, state methods and attributes available for extracting the state information include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseGaussianState.html#strawberryfields.backends.BaseGaussianState.means"><code class="docutils literal notranslate"><span class="pre">means()</span></code></a> and <a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseGaussianState.html#strawberryfields.backends.BaseGaussianState.cov"><code class="docutils literal notranslate"><span class="pre">cov()</span></code></a> for returning the vector of means and the covariance matrix of the specified modes</p></li>
<li><p><a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseState.html#strawberryfields.backends.BaseState.fock_prob"><code class="docutils literal notranslate"><span class="pre">fock_prob()</span></code></a> for returning the probability that the photon counting pattern specified by <code class="docutils literal notranslate"><span class="pre">n</span></code> occurs</p></li>
<li><p><a class="reference external" href="https://strawberryfields.readthedocs.io/en/stable/code/api/strawberryfields.backends.BaseState.html#strawberryfields.backends.BaseState.reduced_dm"><code class="docutils literal notranslate"><span class="pre">reduced_dm()</span></code></a> for returning the reduced density matrix in the fock basis of mode <code class="docutils literal notranslate"><span class="pre">n</span></code></p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<p>[1] Dagmar Bruß. Characterizing entanglement. Journal of Mathematical Physics,
43(9):4237-4251, Sep 2002. URL: https://doi.org/10.1063/1.1494474, doi:10.1063/1.1494474.</p>
<p>[2] Charles H. Bennett, Gilles Brassard, Claude Crépeau, Richard Jozsa, Asher Peres, and
William K. Wootters. Teleporting an unknown quantum state via dual classical and
Einstein-Podolsky-Rosen channels. Physical Review Letters, 70:1895-1899, Mar 1993.
doi:10.1103/PhysRevLett.70.1895.</p>
<p>[3] A. Furusawa and P. van Loock. Quantum Teleportation and Entanglement:
A Hybrid Approach to Optical Quantum Information Processing. Wiley, 2011.
ISBN 9783527635290. URL: https://books.google.ca/books?id=eKxHZ0UHEU4C.</p>
<p>[4] W.H. Steeb and Y. Hardy. Problems and Solutions in Quantum Computing and
Quantum Information. World Scientific, 2006. ISBN 9789812567406.
URL: https://books.google.ca/books?id=HGMy_dSmfbkC.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Basic tutorial: quantum teleportation</a><ul>
<li><a class="reference internal" href="#background-theory">Background theory</a></li>
<li><a class="reference internal" href="#importing-strawberry-fields">Importing Strawberry Fields</a></li>
<li><a class="reference internal" href="#program-initialization">Program initialization</a></li>
<li><a class="reference internal" href="#circuit-construction">Circuit construction</a></li>
<li><a class="reference internal" href="#executing-the-program">Executing the program</a></li>
<li><a class="reference internal" href="#results-and-visualization">Results and visualization</a></li>
<li><a class="reference internal" href="#full-program">Full program</a></li>
<li><a class="reference internal" href="#footnotes">Footnotes</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>