<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Creating a Bell state with cross-resonance pulses on OQC’s Lucy - Amazon Braket Examples documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Amazon Braket Examples  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Amazon Braket Examples  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  
</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="creating-a-bell-state-with-cross-resonance-pulses-on-oqc-s-lucy">
<h1>Creating a Bell state with cross-resonance pulses on OQC’s Lucy<a class="headerlink" href="#creating-a-bell-state-with-cross-resonance-pulses-on-oqc-s-lucy" title="Permalink to this heading">#</a></h1>
<p>In this notebook we will investigate cross-resonance mechanisms to create a Bell state, i.e., the <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">world!</span></code> example in quantum computing.</p>
<p>The simplest circuit to generate a Bell pair is an Hadamard gate on a first qubit followed by a CNOT gate between this qubit and a second qubit. However, diving deeper in the pulse implementation of such gates, we would realize that they require specific mechanisms that are tightly connected to the hardware type and device architecture. Focusing on the capabilities of OQC’s Lucy device, we will replace the canonical CNOT gate with a different entangling gate that is either the cross-resonance (CR) gate or its echoed version. We will then see how two qubits interact when we drive one qubit at the frequency of the other and calibrate this process to be able to create a Bell pair.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use Braket SDK Cost Tracking to estimate the cost to run this example</span>
<span class="kn">from</span> <span class="nn">braket.tracking</span> <span class="kn">import</span> <span class="n">Tracker</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tracker</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s first start with importing some packages as usual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">braket.aws</span> <span class="kn">import</span> <span class="n">AwsDevice</span>
<span class="kn">from</span> <span class="nn">braket.pulse</span> <span class="kn">import</span> <span class="n">PulseSequence</span><span class="p">,</span> <span class="n">ConstantWaveform</span>

<span class="kn">from</span> <span class="nn">braket.circuits</span> <span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">Observable</span>
<span class="kn">from</span> <span class="nn">braket.parametric</span> <span class="kn">import</span> <span class="n">FreeParameter</span>
</pre></div>
</div>
</div>
</div>
<p>We will use two qubits, #0 amd #1, that are physically connected to each other. We also instantiate an OQC device to extract frames and submit circuits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">AwsDevice</span><span class="p">(</span><span class="s2">&quot;arn:aws:braket:eu-west-2::device/qpu/oqc/Lucy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="bell-pair-with-the-h-ecr-and-v-gates">
<h2>Bell pair with the H, ECR and V gates<a class="headerlink" href="#bell-pair-with-the-h-ecr-and-v-gates" title="Permalink to this heading">#</a></h2>
<p>First we show how to transform the canonical Bell state circuit into another one where we replace the CNOT gate by an echoed cross-resonance (ECR) gatet and a V gate, also known as SX (square-root of X). These gates are native on the Lucy device.</p>
<p>As shown in Phys. Rev. B. 81, 134507 (2010) and Phys. Rev. Applied 12, 064013, the ECR gate implements an unitary evolution of the system that can be decomposed in two steps with a time reversal half way through the process to suppress most undesired evolution.
$$ R_{ZX}(\pi/4)-R_X(\pi)-R_{ZX}(\pi/4).$$
The $R_{ZX}$ is interpretable as the rotation of the second qubit, conditioned by the state of the first qubit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bell_pair_with_gates</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">ecr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bell_pair_with_gates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T  : |0| 1 |2|
              
q0 : -H-ECR---
        |     
q1 : ---ECR-V-

T  : |0| 1 |2|
</pre></div>
</div>
</div>
</div>
<p>The circuit is then executed on the OQC device and we plot the measurement histogram which indicates that we created $$\frac{|00\rangle+e^{i\phi}|11\rangle}{\sqrt{2}}$$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb_shots</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">bell_pair_with_gates</span><span class="p">,</span> <span class="n">shots</span> <span class="o">=</span> <span class="n">nb_shots</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">measurement_counts</span>


<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="p">),</span> <span class="p">[</span><span class="n">counts</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">nb_shots</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Population&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Population&#39;)
</pre></div>
</div>
<img alt="../../_images/ba67ba10812c66eb0d3e361939bb88db64f63736e7a4b8b2d8d85f1e50ed2ceb.png" src="../../_images/ba67ba10812c66eb0d3e361939bb88db64f63736e7a4b8b2d8d85f1e50ed2ceb.png" />
</div>
</div>
</section>
<section id="bell-pair-with-the-pulse-implementation-of-the-cross-resonance-sequence">
<h2>Bell pair with the pulse implementation of the cross-resonance sequence<a class="headerlink" href="#bell-pair-with-the-pulse-implementation-of-the-cross-resonance-sequence" title="Permalink to this heading">#</a></h2>
<p>Instead of tackling the implementation of the complete echoed cross resonance pulse sequence, we use a simple cross-resonance (CR) gate. The CR gate is a single-pulse gate that implements the unitary transformation $$ \exp(−i \beta Z X / 2),$$ where Z and X are the 2x2 Pauli matrices. Practically, you can understand the gate by isolating its action for each eigenstate of the control qubit. If it is in $|0\rangle$ (resp. $|1\rangle$), the target qubit undergoes a rotation of angle $\beta$ (resp. $-\beta$).</p>
<p>We seek to measure the interaction strength between the qubits when we drive one of them at the frequency of the other. For this, we use the frame <code class="docutils literal notranslate"><span class="pre">q0_q1_cross_resonance</span></code> that is bound to qubit 0 but tuned up to the frequency of qubit 1. As we will test this pulse sequence in a quantum circuit containing single-qubit gates on other qubits, we also declare the 1-qubit drive frames for 0 and 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q0_q1_CR</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;q</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">_q</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">_cross_resonance&#39;</span><span class="p">]</span>
<span class="n">q0</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;q</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">_drive&#39;</span><span class="p">]</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;q</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s1">_drive&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The sequence consists of a single square pulse of amplitude 0.18. This value has been determined by running the circuits below for different amplitudes and choosing the one that optimizes the difference of the expectation values $\langle IZ \rangle$ taken for the opposite initialization of the control qubit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="o">=</span> <span class="n">FreeParameter</span><span class="p">(</span><span class="s2">&quot;length&quot;</span><span class="p">)</span>
<span class="n">const_wf</span> <span class="o">=</span> <span class="n">ConstantWaveform</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mf">0.18</span><span class="p">)</span>

<span class="n">cross_resonance_sequence</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">PulseSequence</span><span class="p">()</span>
    <span class="o">.</span><span class="n">barrier</span><span class="p">([</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q0_q1_CR</span><span class="p">])</span>
    <span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">q0_q1_CR</span><span class="p">,</span> <span class="n">const_wf</span><span class="p">)</span>
    <span class="o">.</span><span class="n">barrier</span><span class="p">([</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q0_q1_CR</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We run two batches of circuits where we vary the length of the pulse from 12ns to 1.4 µs. Each batch has a different initialized state: $|0\rangle$ for the first, $|1\rangle$ for the second.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12e-9</span><span class="p">,</span> <span class="mf">1.5e-6</span><span class="p">,</span> <span class="mf">36e-9</span><span class="p">)</span>
<span class="n">nb_shots</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Initialization of the control qubit in 0</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Circuit</span><span class="p">()</span>
    <span class="o">.</span><span class="n">pulse_gate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pulse_sequence</span><span class="o">=</span><span class="n">cross_resonance_sequence</span><span class="p">)</span>
    <span class="o">.</span><span class="n">expectation</span><span class="p">(</span><span class="n">observable</span> <span class="o">=</span> <span class="n">Observable</span><span class="o">.</span><span class="n">I</span><span class="p">()</span> <span class="o">@</span> <span class="n">Observable</span><span class="o">.</span><span class="n">Z</span><span class="p">(),</span><span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">CR_circuits</span> <span class="o">=</span> <span class="p">[</span><span class="n">circuit</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lengths</span><span class="p">]</span>
<span class="n">batch_init_0</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">run_batch</span><span class="p">(</span><span class="n">CR_circuits</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">nb_shots</span><span class="p">,</span> <span class="n">disable_qubit_rewiring</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialization of the control qubit in 1</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Circuit</span><span class="p">()</span>
    <span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pulse_gate</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pulse_sequence</span><span class="o">=</span><span class="n">cross_resonance_sequence</span><span class="p">)</span>
    <span class="o">.</span><span class="n">expectation</span><span class="p">(</span><span class="n">observable</span> <span class="o">=</span> <span class="n">Observable</span><span class="o">.</span><span class="n">I</span><span class="p">()</span> <span class="o">@</span> <span class="n">Observable</span><span class="o">.</span><span class="n">Z</span><span class="p">(),</span><span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">CR_circuits</span> <span class="o">=</span> <span class="p">[</span><span class="n">circuit</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lengths</span><span class="p">]</span>
<span class="n">batch_init_1</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">run_batch</span><span class="p">(</span><span class="n">CR_circuits</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">nb_shots</span><span class="p">,</span> <span class="n">disable_qubit_rewiring</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We analyze the data by plotting the expectation value $\langle IZ \rangle$ versus the pulse duration for each batch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IZ_exp_value_init_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">batch_init_0</span><span class="o">.</span><span class="n">results</span><span class="p">()])</span>
<span class="n">IZ_exp_value_init_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">batch_init_1</span><span class="o">.</span><span class="n">results</span><span class="p">()])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">IZ_exp_value_init_0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Control in 0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">IZ_exp_value_init_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Control in 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Pulse duration (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;&lt;IZ&gt;&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x11e14e150&gt;
</pre></div>
</div>
<img alt="../../_images/1b2bb988dfb94e9c57c4900f2781f3d62dc945c61d2cec0391acecc2ed0e8950.png" src="../../_images/1b2bb988dfb94e9c57c4900f2781f3d62dc945c61d2cec0391acecc2ed0e8950.png" />
</div>
</div>
<p>The plot displays a state-dependent oscillatory behavior indicating that we have implemented a unitary evolution based on the ZX interaction. We see also from the previous plot that, for pulse duration of 700ns, the two qubits interacts long enough for the state of the target qubit (i) to be flipped if the control qubit is its ground state or (ii) to cycle back to the original state if the control is in the excited state. Adding an X gate after this sequence would give the expected for the CNOT gate.</p>
<p>Fixing the duration of the pulse to this particular value, we can now create a circuit including our custom pulse sequence and create a Bell state</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RZX_sequence</span> <span class="o">=</span> <span class="n">cross_resonance_sequence</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">700e-9</span><span class="p">)</span>

<span class="n">bell_pair_with_pulses</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Circuit</span><span class="p">()</span>
    <span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pulse_gate</span><span class="p">([</span><span class="n">a</span> <span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="n">pulse_sequence</span><span class="o">=</span><span class="n">RZX_sequence</span><span class="p">)</span>
    <span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now can execute this circuit, which returns similar results as with the circuit using an ECR gate.</p>
<p>We can however notice that the fidelity is worse than in the first case, due to the fact that we did not include any correction for crosstalks such as cross-resonant cancelation, pulse synchronization and an echo scheme. To dive deeper and investigate methods to improve these results, see the following paper Phys. Rev. Applied 12, 064013.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb_shots</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">bell_pair_with_pulses</span><span class="p">,</span> <span class="n">shots</span> <span class="o">=</span> <span class="n">nb_shots</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">measurement_counts</span>


<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="p">),</span> <span class="p">[</span><span class="n">counts</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">nb_shots</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;State&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Population&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Population&#39;)
</pre></div>
</div>
<img alt="../../_images/9895c720195cdda00e2c6e29ae2dcb7f6e13751d6af036815e1bf94350f18a0c.png" src="../../_images/9895c720195cdda00e2c6e29ae2dcb7f6e13751d6af036815e1bf94350f18a0c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Task Summary&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">quantum_tasks_statistics</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Note: Charges shown are estimates based on your Amazon Braket simulator and quantum processing unit (QPU) task usage. Estimated charges shown may differ from your actual charges. Estimated charges do not factor in any discounts or credits, and you may experience additional charges based on your use of other services such as Amazon Elastic Compute Cloud (Amazon EC2).&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated cost to run this example: </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">qpu_tasks_cost</span><span class="p">()</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">simulator_tasks_cost</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> USD&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Task Summary
{&#39;arn:aws:braket:eu-west-2::device/qpu/oqc/Lucy&#39;: {&#39;shots&#39;: 84600, &#39;tasks&#39;: {&#39;COMPLETED&#39;: 86}}}
Note: Charges shown are estimates based on your Amazon Braket simulator and quantum processing unit (QPU) task usage. Estimated charges shown may differ from your actual charges. Estimated charges do not factor in any discounts or credits, and you may experience additional charges based on your use of other services such as Amazon Elastic Compute Cloud (Amazon EC2).
Estimated cost to run this example: 55.410 USD
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Creating a Bell state with cross-resonance pulses on OQC’s Lucy</a><ul>
<li><a class="reference internal" href="#bell-pair-with-the-h-ecr-and-v-gates">Bell pair with the H, ECR and V gates</a></li>
<li><a class="reference internal" href="#bell-pair-with-the-pulse-implementation-of-the-cross-resonance-sequence">Bell pair with the pulse implementation of the cross-resonance sequence</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>